<style>
	.table {
		border-collapse: collapse;
		width: 100%;
		text-align: center;
	}
	.table td {
		border: 1px solid #ccc;
		line-height: 2em;
	}
	.table tr.current {
		background-color: #ededed;
	}
	.none {
		display: none;
	}
	.btn {
		padding: .5em 1em;
		border-radius: 3px;
		color: #333;
		border:1px solid #ccc;
		cursor: pointer;
		display: inline-block;
	}
	.btns {
		margin-bottom: .5em;
	}
</style>
<script>
$("#froms").submit("onsubmit",function(event){
	//1.获取用户输入
		var id=$("input[name=id]").val();
		var realname=$("input[name=realname]").val();
		var telephone=$("input[name=telephone]").val();
		var idcard=$("input[name=idcard]").val();
		var status=$("input[name=status]").val();
		var password=$("input[name=password]").val();
		
		var url=baseURL+"/waiter/insertWaiter";
		var date;
		if(id){
			date={
				id:id,
				realname:realname,
				telephone:telephone,
				idcard:idcard,
				status:status,
				password:password
			}
		}else{
			date={
				realname:realname,
				telephone:telephone,
				idcard:idcard,
				status:status,
				password:password
			}
		}//对象
		 
		$.post(url,date,function(response){
			alert(response.message);
			reloadData();
		})
		
		
	})
//给删除按钮绑定事件
	$("tbody").on("click","a",function(event){
				if(event.target.className=="btn_del"){
						var id=event.target.parentNode.parentNode.firstElementChild.firstElementChild.value;
						url=baseURL+"/waiter/deleteWaiterById";
						 data="id="+id;
						$.get(url,data,function(response){
							if(response.status===200){
								reloadData();
							}else{
								alert(response);
							}
						})
						}
                if(event.target.className=="btn_upd"){
                	    var realname=event.target.parentNode.parentNode.children[1].innerText;
						var	telephone=event.target.parentNode.parentNode.children[2].innerText;
						var	status=event.target.parentNode.parentNode.children[4].innerText;
						var	idcard=event.target.parentNode.parentNode.children[3].innerText;
						var	password=event.target.parentNode.parentNode.children[5].innerText;
						var id=$("input[name=id]").val(id);
						var realname=$("input[name=realname]").val(realname);
						var telephone=$("input[name=telephone]").val(telephone);
						var idcard=$("input[name=idcard]").val(idcard);
						var status=$("input[name=status]").val(status);
						var password=$("input[name=password]").val(password);
						url=baseURL+"/waiter/updateWaiter";
						date={
						id:id,
						realname:realname,
						telephone:telephone,
						idcard:idcard,
						status:status,
						password:password	
						}
						$.post(url,date,function(response){
							if(response.status===200){
								reloadData();
							}else{
								alert(response);
							}

						})
                }
			

		})
var baseURL = "http://134.175.154.93:6677";
// 重载数据
function reloadData(){
	var url = baseURL+"/waiter/findAllWaiter";
	$.get(url,function(response,status){
		//1. 将tbody清空
		$("#waiter_tbl tbody").empty();
		//2. 追加新的值
		response.data.forEach(function(item){
			var newTr = $(`<tr>
				<td><input type="checkbox" value="`+item.id+`" class="td_1"></td>
				<td  class="td_2">`+item.realname+`</td>
				<td class="td_3">`+item.telephone+`</td>
				<td class="td_4">`+item.idcard+`</td>
				<td class="td_5">`+item.status+`</td>
				<td class="td_6">`+item.password+`</td>
				<td>
					<a class="btn_del" href="#">删除</a>
					<a class="btn_upd" href="#">修改</a>
				</td>
			</tr>`);
			$("#waiter_tbl").append(newTr)
		})
	})
}
reloadData();


</script>
<div class="waiter">
<div class="btns">
		<div id="btn_add" class="btn">添加</div>
		<div id="btn_import" class="btn">批量导入</div>
	</div>
	<div style="margin-bottom: .5em">
		<!-- 表单 -->
		<form action="javascript:void(0)" id="froms">
			<input type="hidden" name="id" />
			姓名<input type="text" name="realname"/>
			手机号 <input type="text" name="telephone"/>
			身份证号 <input type="text" name="idcard"/>
			状态<input type="text" name="status"/>
			密码<input type="text" name="password"/>
			<input type="submit" value="提交">
		</form>
	</div>

	<table class="table" id="waiter_tbl">
		<thead>
			<tr>
				<td width="80px">编号</td>
				<td>姓名</td>
				<td>手机号</td>
				<td>身份证号</td>
				<td>状态</td>
				<td>密码</td>
				<td width="100px">操作</td>
			</tr>
		</thead>
		<tbody>
			<tr class="onoe">
				<td><input type="checkbox"></td>
				<td></td>
				<td></td>
				<td></td>
				<td>
					<a href="#" class="btn_upd">修改</a>
					<a href="#" class="btn_del">删除</a>
				</td>
			</tr>
		</tbody>
	</table>
</div>
